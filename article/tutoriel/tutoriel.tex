%===========================================================
%                              Choix de track
%===========================================================
% Une des trois options 'parallelisme', 'architecture', 'systeme' 
% doit être utilisée avec le style compas2017
\documentclass[parallelisme]{compas2017}
\usepackage{rotating}
\usepackage{comment}

\usepackage{graphicx}

\newcommand\vrpath{../../lab/setup/simschlouder/validation-results/}
\graphicspath{{\vrpath}}

%===========================================================
%                               Title
%===========================================================

\toappear{1} % Conserver cette ligne pour la version finale

\begin{document}

\title{SCHIaaS : Un laboratoire d'études d'algorithmes par la simulation des clouds.}
\shorttitle{Simuler les clouds}

\author{Julien Gossa, Stéphane Genaud, Luke Bertot}% A voir l'ordre.

\address{Université De Strasbourg,\\
Laboratoire ICube - Pôle API - 300 Bd Sébastien Brant\\
67400 Illkirch-Graffenstaden - France\\
julien.gossa@unistra.fr genaud@unistra.fr lbertot@unistra.fr}

\date{\today}

\maketitle

%===========================================================         %
%R\'esum\'e
%===========================================================  
\begin{abstract}

Les clouds ont été intensivement étudiés les dernières années, que ce soit du 
point de vue de l'administrateur qui doit par exemple décider de l'emplacement
des machines virtuelles sur l'infrastructure matérielle, ou du client qui doit 
décider du dimentionnement de sa plateforme virtuelle. Pour ce faire, de nombreux
simulateurs ont vu le jour. Malheureusement, ces derniers se limitent souvent à 
mimer les fonctionnalités d'un cloud. Ils ne proposent pas un cadre complet d'étude
des résultats obtenus, pourtant indispensable à la reproductibiltié des expériences
et la comparaison de solutions différentes. De plus, ils manquent d'ancrage dans la 
réalité, en raison d'une part d'une absence de comparaison à des exécutions réelles, 
et d'autre part d'un ensemble de traces réelles injectables dans les simulations.
Le projet SCHIaaS vise à combler ces deux manques. Nous montrons l'architecture de 
ce \textit{framework}, puis les résultats des expériences de validation.

  \MotsCles{un maximum de 5 mots significatifs, en français, doivent être 
    isolés sous forme de mots-clés.}
\end{abstract}


%=========================================================
\section{Introduction}
%=========================================================




%=========================================================
\section{Etat de l'Art}
%=========================================================

EMUSIM combines  emulation and  simulation to extract  information automatically
from  the application  behavior (via  emulation)  and uses  this information  to
generate the  corresponding simulation  model. Such a  simulation model  is then
used  to  build  a simulated  scenario  that  is  closer  to the  actual  target
production  environment   in  terms   computing  resources  available   for  the
application and request patterns.
- EMUSIM operates uniquely with information that is available for customers of public IaaS providers
- Automated Emulation Framework (AEF) [2] for emulation and CloudSim [3] for simulation
- emulation : run the actual software on a subset of the hardware (=hardware model)
- application BoT

%=========================================================
\section{Présentation du \textit{framework}}
%=========================================================

SCHIaaS est un \textit{framework} permettant le développement rapide de simulateurs 
de cloud pour l'évaluation d'algorithmes au niveau du \textit{cloud-kit} et au dessus.
Il est basé sur SimGrid et est développé en JAVA, ce qui permet la spécialisation 
rapide d'un ensemble de classes permettant de greffer les travaux de l'utilisateur au 
niveau qui lui convient, le reste étant assuré par défaut.
Le tout est facilement instrumentable par un ensemble de scripts, appelée \emph{lab},
qui permet d'automatiser l'exécution des simulations, leurs observations, et l'analyse
des résultats.

Schema :

lab (lab.py + schiaas-trace-utils.py )

applications (simschlouder, loadinjector, ...)

schiaas (engines + apps)

simgrid (vm + msg)


\subsection{SCHIaaS}

SCHIaaS est la sur-couche de SimGrid, qui ajoute par dessus l'interface MSG toutes les 
fonctionnalités d'un cloud. 
Le niveau \textit{cloud-kit} est assuré par mes moteurs, exposant les fonctionnalités 
des clouds au niveau administrateur :
\begin{itemize}
 \item Compute : moteur d'instanciation et de gestion des VM;
 \item Storage : moteur de gestion des stockages;
 \item Network : moteur de gestion de la virtualisation du réseau (à l'état purement abstrait pour l'instant).
\end{itemize}

Chacun de ces moteurs est une interface abstraite, qui assure l'interopérabilité entre eux, 
ainsi qu'avec les autres niveaux du \textit{framework}. Des implémentations sont fournies, qui 
permettent d'obtenir un simulateur par défaut pleinement fonctionnel. Ces implémentations 
imitent le comportement d'openstack. Un développeur de fonctionnalités administrateur n'a donc 
qu'à se concentrer sur la partie qui l'intéresse, par exemple différent systèmes de stockages.

De plus, les ordonanceurs de VM, qui décident sur quelle PM seront déployées les VM demandées
par l'utilisateur, ont également leur interface abstraite. Plusieurs ordonnanceurs par défaut
sont fournis, sur l'exemple d'Openstack qui permet au choix d'équilibrer ou de consolider les 
charges des machines physiques au moyen d'un poids calculé pour chacune d'elles. 
Tout moteur compute peut donc réutiliser tout algorithme d'ordonnancement.

Un système abstrait d'injection de charge est également fourni. Ce dernier permet de contrôler 
un nombre de VM déployées et les charges de ces VM, en particulier CPU, afin de faciliter 
l'évaluation des algorithmes. 
Deux injecteurs par défaut sont fournis. Le premier est un simple injecteur de charges sinusoidales
entièrement paramétrables. Le second injecte les charges observées sur l'infrastructure de Google,
et rendue disponible dans le google-cluster-traces.

Ainsi, SCHIaaS fourni, de façon modulaire, tous mes composant d'un \textit{cloud-kit}. 
Chaque module peut être remplacé, étendu, ou utilisé en l'état, ce qui permet le prototypage
rapide de simulateur de cloud adapté à l'étude de l'utilisateur.

\subsection{Applications}

SCHIaaS ne peut s'exécuter seul. Dans la philosophie SimGrid, un simulateur est une application
exploitant les fonctionnalités fournies, mais qui doit être développée et compilée.
Cette philosophie est conservée avec SCHIaaS, qui ne fait qu'étendre les fonctionnalités de 
SimGrid avec celles disponibles dans un cloud.

Cependant, deux applications sont fournies par défaut: \emph{LoadInjector} et \emph{SimSchlouder}.

\subsubsection{LoadInjector}

L'application \emph{LoadInjector} permet le prototypage rapide de simulateurs pour évaluer les 
algorithmes du niveau \textit{cloud-kit}. Dans ces cas là, seule compte la charge en terme de nombre 
de VMs et de CPU de ces VMs, peu importe les applications qui y sont exécutées.

L'exemple typique est celui de l'étude d'algorithme de placement de VM sur PM, il est développé section ???

\subsection{SimSchlouder}

L'application \emph{SimSchlouder} permet le prototypage rapide de simulateurs pour évaluer les 
algorithmes d'ordonnancement de VM et de tâches au niveau utilisateurs du cloud. 
Dans ces cas là, l'état de l'infrastructure interne du cloud importe peu, seule compte le service 
rendu à l'utilisateur, isolé sur sa propre plateforme virtuelle. 

Schlouder citation??? est un courtier de ressources virtuelles. Il prend en entrée la description 
d'une charge de travail, au format slurm citation??? étendu de quelques informations permettant 
d'adapter le courtage aux besoins utilisateurs. Ensuite, Schlouder anaylse la charge de travail 
soumise, et décide à l'aide d'algorithmes de dimensionnement (\textit{provisioning}) de déployer 
un certains nombres de VM, puis ordonnance les tâches sur ces VMs, et étend les VMs lorsqu'elles
sont devenues inutiles.

SimSchlouder est l'alter-égo de Schlouder, dont l'architecture, les fonctionnalités, le comportement
et les entrées/sorties sont entièrement reproduite dans SCHIaaS. La description d'une charge de 
travail peut donc être soumise indifférement à Schlouder pour une exécution réelle, ou à SimSchlouder
pour une évaluation des choix de courtage par la simulation. Une option de Schlouder permet 
d'ailleurs d'appeler directement SimSchlouder, et d'obtenir le temps de completion et le prix 
de l'exécution demandée en fonction de la plateforme de cloud cible et de la stratégie de réservation
de VM choisie.

Les stratégies d'évaluation des réservations de ressources de cloud ont été intensivement étudiées 
ces dernières années. Cependant, elles sont rarement comparées entre elles, et leur évaluation 
est souvent basée sur des simulations ad-hoc ou inadaptées, et des charges de travail purement artificielles.
SimSchlouder permet de rapidement développer de telles stratégies, et de comparer leurs performances 
à celles fournies par défaut, à savoir ASAP (\textit{As Soon As Possible}, qui vise à minimiser le temps de 
complétion) et AFAP (\textit{As Full As Possible}, qui vise à minimiser les réservations de ressources,
et donc le coût). De plus, cette comparaison peut s'appuyer sur les traces récupérées lors de l'utilisation 
de l'application réelle Schlouder. Pour l'instant, nous mettons à disposition 481 traces d'exécutions
sur deux plateformes : notre cloud privé, homogène, stable et non partagé, et BonFire qui est un cloud 
public hétérogène, instable et partagé, dont les différents sites ont des comportements et des matériels 
assez différents pour qu'on les considère ocmme des clouds différents.
Les charges de travail sont issues de deux applications : OMSSA, qui est un sac de tâches assez courtes 
en protéomique, et MONTAGE, qui est un \textit{workflow} en astronomie ayant des tâches plus imposantes. 

Ainsi, l'utilisation de SimSchlouder permet de ne développer que le coeur d'un stratégie de résevation 
de resources, simplement en implémentant une interface abstraite très simple, pour pouvoir comparer cette 
stratégie aux autres dans des contextes applicatifs et matériels nombreux, représentatifs, et réellement 
éprouvés.

Ces comparaisons nécessitent de très nombreuses simulations, c'est pourquoi nous avons conçu \emph{le lab}.

\subsection{Le Lab}

Le lab est un ensemble de scripts permettant d'automatiser l'exécution des simulations, la collecte des
observations, ainsi que leur analyse. Il permet donc d'exécuter de bout-en-bout l'étude par simulation,
de la définition des différentes simulations, à la production des graphiques.

Au delà de l'aspect pratique et du gain de temps de mise en oeuvre de l'étude, le lab a pour vocation
de ``standardiser'' l'étude. Cette standardisation assure sa reproductibilité, ainsi qu'une comparaison
équitable avec d'autres solutions au même problème.

Mais le lab permet également une approche systématique permetant à l'expérimentateur de ne pas rater 
de phénomène. En effet, il est fréquent de faire un grand lot de simulations, plus d'observer plus
finement celles qui présentent des particularités. Ce faisant, l'expérimentateur exclu les autres 
simulation de ces observations plus précises, à moins de les refaire entièrement. En rendant plus 
pratique la définition des observations directement au niveau du \textit{worflow} de simulations, 
le lab assure que tous les cas seront observés de la même manière, ce qui évite de rater un phénomène,
ou de différencier le traitement des simulations au risque d'arriver à des conclusions abusives.


%=========================================================
\section{Exemples}
%=========================================================

\subsection{Comparaison d'algorithmes de placement de VM sur PM}

\subsection{Comparaison d'algorithmes d'ordonnancement de tâches sur VM}

\section{Open-science}

\begin{verbatim}
git clone https://git.unistra.fr/gossa/schlouder-traces.git
git clone https://scm.gforge.inria.fr/anonscm/git/schiaas/schiaas.git 
cd schiaas
cmake .
make
cd lab
./lap.py -p2 setup/simschlouder/validation.cfg
cd setup/simschlouder/validation-results
ls
\end{verbatim}


\bibliography{biblio}

\end{document}



